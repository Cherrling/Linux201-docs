# Cron

Cron是一个基于"定时"的作业调度器，在Unix-like操作系统中广泛使用。它允许用户安排在特定时间或周期性执行的作业，例如自动备份、系统更新和定期清理等任务。Cron在后台作为守护进程运行，并检查/etc/crontab文件、/etc/cron.*目录和用户的crontab文件以执行预定的任务，在指定的时间执行它们。

在本手册中，我们将详细介绍如何使用crontab文件配置任务，包括语法、时间参数的设置以及如何管理和排除故障cron作业。
 
每个用户都可以有自己的crontab文件，而/etc/crontab文件则是系统级的。用户可以通过crontab命令编辑自己的作业调度。

## 编辑Crontab
 
要编辑或创建用户的crontab文件，可以使用以下命令：

```
crontab -e
```

Crontab文件的每一行都代表一个作业，格式如下：

```
* * * * * command_to_execute  
```

这五个星号代表不同的时间单位：

- 第一个星号的部分代表分钟（0到59）

- 第二个星号的部分代表小时（0到23）

- 第三个星号的部分代表一个月中的日期（1到31）

- 第四个星号的部分代表月份（1到12）

- 第五个星号的部分代表星期几（0到7，其中0和7都代表星期日）

每个字段可以使用以下字符来指定不同的时间：

- 星号（*）：表示任何可能的值，例如，在小时字段中使用星号意味着"每个小时"。

- 逗号（,）：允许列举多个值，例如，1,3,5表示"在1点、3点和5点"。

- 中划线（-）：表示一个范围，例如2-4表示"2点到4点"。

- 正斜杠（/）：表示步长，*/2在小时字段中使用表示"每两个小时"

## 示例

1. 每天午夜12点运行 `backup.sh` 脚本：

    ```
    0 0 * * * /path/to/backup.sh  
    ```

2. 每个工作日的上午9点到下午5点，每小时的第30分钟运行 `check.sh` 脚本：

    ```
    30 9-17 * * 1-5 /path/to/check.sh
    ```
 
3. 每两个小时运行一次 `sync.sh` 脚本：

    ```
    0 */2 * * * /path/to/sync.sh
    ```
 
## 管理Crontab
 

查看用户的crontab文件内容：

```
crontab -l
``` 

删除用户的crontab文件：

```
crontab -r
```

## 故障排除
 
有的时候Cron任务可能没有按预期运行，可以按照以下几点检查：

- 确保Cron服务正在运行。

- 检查Cron日志（通常在/var/log/cron或通过journalctl命令查看）以了解作业执行情况。

- 确保crontab文件的命令行路径是正确的。

- 确保命令行是可执行的，并且所有的文件权限都是正确的。

- 注意Cron环境变量可能与用户环境变量不同，可能需要在脚本中显式设置环境变量。